---
title: "MTA Shutdown"
description: |
  Is the NYC subway system as dire as we say it is?
preview: preview.gif   
author:
  - name: Jason Bixon
    url: https://jasonbixonblog.netlify.com
    affiliation: Merkle Inc.
    affiliation_url: https://merkleinc.com
date: 04-14-2019
repository_url: https://github.com/jbixon13/Radix-blog
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r message=FALSE, echo=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
library(plotly)
library(scales)
```


```{r message=FALSE, echo=FALSE}
# read in datasets 
MTA_KPI <- read_csv('data/metropolitan-transportation-authority-mta-performance-indicators-per-agency-beginning-2008.csv')    # MTA KPI performance data 
```


I was inspired by this [**CityLab**](https://www.citylab.com/perspective/2018/12/new-york-city-electric-bikes-transit-crisis-de-blasio/577969/) article detailing the impending transportation crisis due to the MTA L Line shutdown. Specifically, I am interested in understanding:observing whether the shutdown contributes to an increase in cyclist injuries due to motor vehicle collisions as about [**275,000 L Line riders**](https://ny.curbed.com/2018/10/3/17925038/nyc-subway-l-train-shutdown-mitigation-alternatives) seek alternatives.  

[**NYC DOT**](http://web.mta.info/sandy/CanarsieTunnelRebuildingProcess.html#sdtr) has predicted about 2% of L Line riders to switch to cycling, while about 79% are predicted to move to other subway lines. I could investigate the dispersion of L Train riders to other options as a whole if data is available, but for now I will focus on cyclist safety as it's more approachable with currently available data. 

Let's look at some performance metrics for the MTA subway network as a whole. Some of the definitions are opaque, so I'll [**specify where necessary.**](http://dashboard.mta.info/)


```{r echo=FALSE}
# convert Period to date variable
transit <- MTA_KPI

transit$Period <- paste(transit$Period, '-01', sep = '')

transit$Period <- transit$Period %>%
  ymd()

 # filter observations to only NYC Transit (Subway and Bus)
transit <- transit %>% 
  dplyr::filter(MTA_KPI$`Agency Name` == 'NYC Transit') %>%
  group_by(Period) 
```

```{r echo=FALSE, message=FALSE, out.width='100%'}
# plot ridership 
plt.NYC.riders <- transit %>% 
  dplyr::filter(`Indicator Name` == 'Total Ridership - Subways') %>%
  ggplot(aes(x = Period, y = `Monthly Actual`)) + 
  geom_point(color = 'steelblue4', alpha = .7) + 
  geom_smooth(method = 'lm') + 
  ylab('Total Monthly Ridership - All Lines') +
  scale_y_continuous(labels = comma) +
  theme_classic()

# convert to plotly object
ggplotly(plt.NYC.riders) %>%
  layout(title = list(text = 'Monthly ridership for the entire network has increased.',
                      font = list(size = 16
                                  )
                      )
         ) %>% 
  config(displayModeBar = FALSE)
```

> "Terminal On-Time Performance measures the percentage of trains arriving at their destination terminals as scheduled. A train is counted as on-time if it arrives at its destination early, on time, or no more than five minutes late, and has not skipped any planned stops. TOTP is a legacy metric that provides a measure of trains arriving within the standard, and not a direct measure of customer travel time, particularly since relatively few customers travel all the way to the end of a line." ---MTA

```{r echo=FALSE, message=FALSE, out.width='100%'}
# plot On-Time Performance for all subway lines
plt.NYC.OTP <- transit %>% 
  dplyr::filter(`Indicator Name` == 'On-Time Performance (Terminal)') %>%
  ggplot(aes(x = Period, y = `Monthly Actual`)) + 
  geom_point(color = 'steelblue4', alpha = .7) + 
  geom_smooth(method = 'lm') + 
  ylab('Monthly On-Time Performance - All Lines') +
  theme_classic()

# convert to plotly object
ggplotly(plt.NYC.OTP) %>% 
  layout(title = list(text = 'Subway cars are arriving at their destination on schedule less.',
                      font = list(size = 16
                                  )
                      )
         ) %>% 
  config(displayModeBar = FALSE)
```

> "Wait Assessment measures how regularly the trains are spaced during peak hours. To meet the standard, the headway (time between trains) can be no greater than 25% more than the scheduled headway. This provides a percentage of trains passing the standard, but does not account for extra service operated, is not weighted to how many customers are waiting for the trains at different stations, does not distinguish between relatively minor gaps in service and major delays, and is not a true measurement of time customers spend waiting on the platform." ---MTA

```{r echo=FALSE, message=FALSE, out.width='100%'}
# plot subway wait assessment for all subway lines
plt.NYC.SWA <- transit %>% 
  dplyr::filter(`Indicator Name` == 'Subway Wait Assessment') %>%
  ggplot(aes(x = Period, y = `Monthly Actual`)) + 
  geom_point(color = 'steelblue4', alpha = .7) + 
  geom_smooth(method = 'lm') +
  ylab('Subway Wait Assessment - All Lines') +
  theme_classic()

# convert to plotly object
ggplotly(plt.NYC.SWA) %>% 
  layout(title = list(text = 'Subway cars are less routinely spaced during peak hours.', 
                      font = list(size = 16
                                  )
                      )
         ) %>% 
  config(displayModeBar = FALSE) 
```

> "Mean Distance Between Failures (MDBF) reports how frequently car-related problems such as door failures, loss of motor power, or brake issues cause a delay of over five minutes. It is calculated by dividing the number of miles train cars run in service by the number of incidents due to car‚Äêrelated problems." --- MTA

```{r echo=FALSE, message=FALSE, out.width='100%'}
# plot mean distance between failures for all subway lines 
plt.NYC.fail <- transit %>% 
  dplyr::filter(`Indicator Name` == 'Mean Distance Between Failures - Subways') %>%
  ggplot(aes(x = Period, y = `Monthly Actual`)) + 
  geom_point(color = 'steelblue4', alpha = .7) + 
  geom_smooth(method = 'lm') +
  ylab('Mean Distance Between Failures (Miles)') +
  scale_y_continuous(labels = comma) +
  theme_classic()

# convert to plotly object
ggplotly(plt.NYC.fail) %>% 
  layout(title = list(text = 'Subway cars are breaking down more frequently.',
                      font = list(size = 16
                                  )
                      )
         ) %>% 
  config(displayModeBar = FALSE)
```

